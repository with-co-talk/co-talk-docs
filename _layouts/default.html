<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
    <meta name="description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
    
    <!-- SEO -->
    {% seo %}
    
    <!-- CSS -->
    <link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="{{ '/assets/favicon.svg' | relative_url }}">
    
    <!-- Font: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- KaTeX for math -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    
    <!-- PlantUML -->
    <script src="https://cdn.jsdelivr.net/npm/plantuml-encoder@1.4.0/dist/plantuml-encoder.min.js"></script>
  </head>
  <body>
    <!-- ì‚¬ì´ë“œë°” -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <a href="{{ site.baseurl }}/" class="logo">
          <span class="logo-icon">ğŸ’¬</span>
          <span class="logo-text">Co-Talk</span>
        </a>
      </div>
      
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">ì‹œì‘í•˜ê¸°</div>
          <ul class="nav-list">
            <li><a href="{{ site.baseurl }}/" class="nav-link {% if page.url == '/' %}active{% endif %}">í™ˆ</a></li>
            <li><a href="{{ site.baseurl }}/PRD" class="nav-link {% if page.url == '/PRD.html' or page.url == '/PRD' %}active{% endif %}">PRD</a></li>
          </ul>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">ê¸°ìˆ  ë¬¸ì„œ</div>
          <ul class="nav-list">
            <li><a href="{{ site.baseurl }}/TECH-STACK" class="nav-link {% if page.url == '/TECH-STACK.html' or page.url == '/TECH-STACK' %}active{% endif %}">Tech Stack</a></li>
            <li><a href="{{ site.baseurl }}/ARCHITECTURE" class="nav-link {% if page.url == '/ARCHITECTURE.html' or page.url == '/ARCHITECTURE' %}active{% endif %}">Architecture</a></li>
            <li><a href="{{ site.baseurl }}/ARCHITECTURE-SCALE" class="nav-link {% if page.url == '/ARCHITECTURE-SCALE.html' or page.url == '/ARCHITECTURE-SCALE' %}active{% endif %}">Architecture Scale</a></li>
            <li><a href="{{ site.baseurl }}/DIAGRAM-GUIDE" class="nav-link {% if page.url == '/DIAGRAM-GUIDE.html' or page.url == '/DIAGRAM-GUIDE' %}active{% endif %}">ë‹¤ì´ì–´ê·¸ë¨ ê°€ì´ë“œ</a></li>
          </ul>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">ê¸°ìˆ  ê²°ì • (ADR)</div>
          <ul class="nav-list">
            <li><a href="{{ site.baseurl }}/MSA-VS-MONOLITH" class="nav-link {% if page.url == '/MSA-VS-MONOLITH.html' or page.url == '/MSA-VS-MONOLITH' %}active{% endif %}">MSA vs Monolith</a></li>
            <li><a href="{{ site.baseurl }}/DATABASE-SELECTION" class="nav-link {% if page.url == '/DATABASE-SELECTION.html' or page.url == '/DATABASE-SELECTION' %}active{% endif %}">Database Selection</a></li>
            <li><a href="{{ site.baseurl }}/SPRING-MVC-VS-WEBFLUX" class="nav-link {% if page.url == '/SPRING-MVC-VS-WEBFLUX.html' or page.url == '/SPRING-MVC-VS-WEBFLUX' %}active{% endif %}">Spring MVC vs WebFlux</a></li>
            <li><a href="{{ site.baseurl }}/REDIS-STREAMS-ORDERING" class="nav-link {% if page.url == '/REDIS-STREAMS-ORDERING.html' or page.url == '/REDIS-STREAMS-ORDERING' %}active{% endif %}">Redis Streams Ordering</a></li>
          </ul>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">í”„ë¡ íŠ¸ì—”ë“œ</div>
          <ul class="nav-list">
            <li><a href="{{ site.baseurl }}/FRONTEND-PLATFORM-STRATEGY" class="nav-link {% if page.url == '/FRONTEND-PLATFORM-STRATEGY.html' or page.url == '/FRONTEND-PLATFORM-STRATEGY' %}active{% endif %}">Platform Strategy</a></li>
            <li><a href="{{ site.baseurl }}/FLUTTER-VS-REACT-NATIVE" class="nav-link {% if page.url == '/FLUTTER-VS-REACT-NATIVE.html' or page.url == '/FLUTTER-VS-REACT-NATIVE' %}active{% endif %}">Flutter vs React Native</a></li>
          </ul>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <a href="https://github.com/with-co-talk/co-talk" class="github-link" target="_blank">
          GitHub
        </a>
      </div>
    </aside>
    
    <!-- ëª¨ë°”ì¼ í—¤ë” -->
    <header class="mobile-header">
      <button class="menu-toggle" id="menuToggle" aria-label="ë©”ë‰´ ì—´ê¸°">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <a href="{{ site.baseurl }}/" class="mobile-logo">Co-Talk</a>
    </header>
    
    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main class="main-content">
      <article class="content">
        {{ content }}
      </article>
    </main>
    
    <!-- ëª¨ë°”ì¼ ì˜¤ë²„ë ˆì´ -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <!-- Scripts -->
    <script>
      // ëª¨ë°”ì¼ ë©”ë‰´ í† ê¸€
      const menuToggle = document.getElementById('menuToggle');
      const sidebar = document.querySelector('.sidebar');
      const overlay = document.getElementById('sidebarOverlay');
      
      menuToggle.addEventListener('click', () => {
        sidebar.classList.toggle('open');
        overlay.classList.toggle('open');
        document.body.classList.toggle('sidebar-open');
      });
      
      overlay.addEventListener('click', () => {
        sidebar.classList.remove('open');
        overlay.classList.remove('open');
        document.body.classList.remove('sidebar-open');
      });
    </script>
    
    <!-- Initialize Mermaid -->
    <script>
      mermaid.initialize({ 
        startOnLoad: true,
        theme: 'neutral',
        themeVariables: {
          primaryColor: '#e8e8e8',
          primaryTextColor: '#333',
          primaryBorderColor: '#ccc',
          lineColor: '#666',
          secondaryColor: '#f4f4f4',
          tertiaryColor: '#fff'
        }
      });
    </script>
    
    <!-- Initialize KaTeX -->
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false},
            {left: "\\[", right: "\\]", display: true},
            {left: "\\(", right: "\\)", display: false}
          ],
          throwOnError: false
        });
      });
    </script>
    
    <!-- Initialize PlantUML -->
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        // PlantUML ì½”ë“œ ë¸”ë¡ ì°¾ê¸° (language-plantuml ë˜ëŠ” language-puml)
        document.querySelectorAll('pre code.language-plantuml, pre code.language-puml').forEach(function(block) {
          try {
            const plantumlCode = block.textContent;
            const encoded = plantumlEncoder.encode(plantumlCode);
            const img = document.createElement('img');
            img.src = 'https://www.plantuml.com/plantuml/svg/' + encoded;
            img.alt = 'PlantUML Diagram';
            img.style.maxWidth = '100%';
            img.style.height = 'auto';
            
            const container = document.createElement('div');
            container.className = 'plantuml-diagram';
            container.appendChild(img);
            
            block.closest('pre').replaceWith(container);
          } catch (e) {
            console.error('PlantUML ë Œë”ë§ ì‹¤íŒ¨:', e);
          }
        });
        
        // @startumlë¡œ ì‹œì‘í•˜ëŠ” ì½”ë“œ ë¸”ë¡ë„ ì²˜ë¦¬
        document.querySelectorAll('pre code').forEach(function(block) {
          const code = block.textContent.trim();
          if (code.startsWith('@startuml') || code.startsWith('@startmindmap') || code.startsWith('@startwbs')) {
            try {
              const encoded = plantumlEncoder.encode(code);
              const img = document.createElement('img');
              img.src = 'https://www.plantuml.com/plantuml/svg/' + encoded;
              img.alt = 'PlantUML Diagram';
              img.style.maxWidth = '100%';
              img.style.height = 'auto';
              
              const container = document.createElement('div');
              container.className = 'plantuml-diagram';
              container.appendChild(img);
              
              block.closest('pre').replaceWith(container);
            } catch (e) {
              console.error('PlantUML ë Œë”ë§ ì‹¤íŒ¨:', e);
            }
          }
        });
      });
    </script>
  </body>
</html>
